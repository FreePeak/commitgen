# Maintainer: FreePeak <contact@freepeak.com>
pkgname=commitgen
pkgver=1.0.0
pkgrel=1
pkgdesc="AI-powered commit message generator"
arch=('x86_64' 'aarch64')
url="https://github.com/FreePeak/commitgen"
license=('MIT')
makedepends=('go')
source=("$pkgname-$pkgver.tar.gz::https://github.com/FreePeak/commitgen/archive/refs/tags/v$pkgver.tar.gz")
sha256sums=()

build() {
  cd "$pkgname-$pkgver"

  export CGO_ENABLED=0
  export GOFLAGS="-buildmode=pie -trimpath -ldflags=-linkmode=external -extldflags=\"$LDFLAGS\""
  export GOPATH="$srcdir/go"

  go build -o bin/commitgen main.go
}

package() {
  cd "$pkgname-$pkgver"

  # Install binary
  install -Dm755 bin/commitgen "$pkgdir/usr/bin/commitgen"

  # Install license
  install -Dm644 LICENSE "$pkgdir/usr/share/licenses/$pkgname/LICENSE"

  # Install documentation
  install -Dm644 README.md "$pkgdir/usr/share/doc/$pkgname/README.md"
}